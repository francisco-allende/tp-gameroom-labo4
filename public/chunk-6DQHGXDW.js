import{a as R}from"./chunk-DKWS7D7Q.js";import{a as T,b as F}from"./chunk-Q6DD7TMD.js";import"./chunk-EXKCJSL7.js";import{M as O,d as M,f as j}from"./chunk-6WCNAO4G.js";import{Ab as u,Fb as E,La as y,Oa as r,Pa as h,V as b,_ as P,ab as S,da as _,db as x,hb as w,ib as A,jb as I,kb as k,lb as a,ma as g,mb as o,na as f,nb as p,qb as v,tb as d,ub as m,x as C,xb as U,yb as c}from"./chunk-VUEWXBX5.js";var V=(()=>{let i=class i{constructor(t){this.http=t,this.apiUrl="https://restcountries.com/v3.1/all"}getCountries(){return this.http.get(this.apiUrl).pipe(C(t=>t.map(e=>({name:e.name.common,flag:e.flags.png}))))}};i.\u0275fac=function(e){return new(e||i)(P(M))},i.\u0275prov=b({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})();function $(s,i){if(s&1){let l=v();a(0,"div",6)(1,"div",9),p(2,"img",10)(3,"br"),a(4,"button",11),d("click",function(){let e=g(l).$implicit,n=m();return f(n.checkAnswer(e))}),c(5,"Esta!"),o()()()}if(s&2){let l=i.$implicit,t=m();r(2),U("src",l==null?null:l.flag,y),r(2),x("disabled",t.showPlayAgain)}}function B(s,i){if(s&1){let l=v();a(0,"button",12),d("click",function(){g(l);let e=m();return f(e.playAgain())}),c(1," Play Again "),o()}}var X=(()=>{let i=class i{constructor(t,e,n){this.api=t,this.toast=e,this.puntosService=n,this.paises=[],this.ochoPaises=[],this.alreadyChosen=[],this.puntos=0,this.paisActual={name:"",flag:""},this.siguientePais={name:"",flag:""},this.vidas=3,this.showPlayAgain=!1,this.getRandomCountryIndex=()=>Math.floor(Math.random()*this.paises.length)}ngOnInit(){this.paisesSubscription=this.api.getCountries().subscribe(t=>{this.paises=t,this.chooseRandomCountry()})}chooseRandomCountry(){let t=this.getRandomCountryIndex();this.mezclarPaises(this.paises[t],t)}mezclarPaises(t,e){this.paisActual=t,this.alreadyChosen.push(this.paisActual),this.paises.splice(e,1),this.randomSort(this.paises),this.paises.unshift(this.paisActual),this.ochoPaises=this.paises.slice(0,8),this.randomSort(this.ochoPaises)}randomSort(t){for(let e=t.length-1;e>0;e--){let n=Math.floor(Math.random()*(e+1));[t[e],t[n]]=[t[n],t[e]]}}checkAnswer(t){let e=this.getRandomCountryIndex();this.siguientePais=this.paises[e];let n=this.paises.indexOf(this.paisActual);n!==-1&&this.paises.splice(n,1),t.name==this.paisActual?.name?this.ganaPuntos():this.pierdePuntos(),this.mezclarPaises(this.siguientePais,e)}ganaPuntos(){this.puntos++,this.toast.success("Correcto!")}pierdePuntos(){this.vidas--,this.puntos--,this.toast.error("Fallaste!"),this.vidas==0&&this.gameOver()}gameOver(){this.sendPoints(),this.toast.info(`Game Over! Puntaje: ${this.puntos}`),this.showPlayAgain=!0}playAgain(){this.showPlayAgain=!1,this.puntos=0,this.vidas=3,this.paises=[],this.paisesSubscription=this.api.getCountries().subscribe(t=>{this.paises=t,this.chooseRandomCountry()})}handleSetUser(t){this.currentUser=t}sendPoints(){this.puntosService.updatePuntos(this.currentUser,this.puntos,"preguntados")}ngOnDestroy(){this.paisesSubscription&&this.paisesSubscription.unsubscribe()}};i.\u0275fac=function(e){return new(e||i)(h(V),h(O),h(R))},i.\u0275cmp=_({type:i,selectors:[["app-preguntados"]],inputs:{currentUser:"currentUser"},standalone:!0,features:[E],decls:22,vars:4,consts:[[3,"sendCurrentUser"],[1,"main"],[1,"container","text-center","justify-content-center","align-items-center"],[1,"title"],[1,"juego","mx-auto"],[1,"row","row-cols-1","row-cols-md-4","g-4"],[1,"col"],[1,"intentos"],[1,"btn","btn-danger"],[1,"card","border-0","mb-3",2,"width","14em","min-height","10rem"],["alt","country flag",1,"bandera",3,"src"],[1,"btn","btn-primary",3,"click","disabled"],[1,"btn","btn-danger",3,"click"]],template:function(e,n){e&1&&(a(0,"app-header",0),d("sendCurrentUser",function(z){return n.handleSetUser(z)}),o(),a(1,"div",1)(2,"div",2)(3,"div",3)(4,"h1"),c(5,"Preguntados"),o(),p(6,"br"),a(7,"h2"),c(8),o()(),a(9,"div",4)(10,"div",5),I(11,$,6,2,"div",6,A),o()(),p(13,"br"),a(14,"div",7)(15,"h4"),c(16),o(),a(17,"h4"),c(18),o()(),p(19,"br"),S(20,B,2,0,"button",8),o()(),p(21,"app-footer")),e&2&&(r(8),u("\xBFQu\xE9 bandera corresponde a ",n.paisActual.name,"?"),r(3),k(n.ochoPaises),r(5),u("Puntos acumulados: ",n.puntos,""),r(2),u("Vidas: ",n.vidas,""),r(2),w(20,n.showPlayAgain?20:-1))},dependencies:[T,F,j],styles:[".main[_ngcontent-%COMP%]{height:100vh;background-color:#91e4f1}.title[_ngcontent-%COMP%]{margin-bottom:2rem}.bandera[_ngcontent-%COMP%]{width:12em;height:7em}.card[_ngcontent-%COMP%]{padding:1em;background-color:#000}"]});let s=i;return s})();export{X as PreguntadosComponent};
